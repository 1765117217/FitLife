<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FitLife | Features</title>
  <meta name="keywords" content="fitness tech, wearable, heart rate, sleep tracking, weather API, training advice" />
  <meta name="description" content="FitLife Features: heart rate tracking, sleep analysis and smart indoor/outdoor training advice powered by a weather API." />

  <!-- Bootstrap 5 + jQuery -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- 你的样式 -->
  <link rel="stylesheet" href="assets/css/ui.css">
  <link rel="stylesheet" href="assets/css/main.css">
  <link rel="stylesheet" href="assets/css/dark-theme.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700;900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    .feature-icon{font-size:2.2rem;}
    .kpi{font-weight:800;font-size:2rem;}
    .api-card .spinner-border{width:1.8rem;height:1.8rem;}
    .badge-tip{font-size:.8rem;}
  </style>
</head>
<body data-page="features">
<!-- 顶部导航 -->
<header class="navbar-elite sticky-top">
  <nav class="navbar navbar-expand-lg navbar-dark bg-black">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
        <span class="fw-bold tracking-wide" style="
          font-family:'Montserrat',sans-serif;
          font-size:1.7rem; font-weight:900; color:#d4af37;
          text-shadow:1px 1px 2px #000,0 0 12px rgba(212,175,55,.6);
          letter-spacing:.8px;">FitLife</span>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain" aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-3">
          <li class="nav-item"><a class="nav-link elite-link px-2" href="exercises.html">Exercises</a></li>
          <li class="nav-item"><a class="nav-link elite-link px-2" href="equipment.html">Equipment</a></li>
          <li class="nav-item"><a class="nav-link elite-link px-2" href="features.html">Features</a></li>
          <li class="nav-item"><a class="nav-link elite-link px-2" href="nutrition.html">Nutrition</a></li>
          <li class="nav-item"><a class="nav-link elite-link px-2" href="contact.html">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="elite-sep"></div>
</header>

<!-- 页头 -->
<section class="bg-light">
  <div class="container py-4">
    <h1 class="h3 fw-bold mb-2">Product Features</h1>
    <p class="text-muted mb-0">
  
    </p>
  </div>
</section>

<!-- 三个特色卡片 -->
<section class="py-4 border-top">
  <div class="container">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="p-4 bg-white border rounded h-100">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-heart-pulse feature-icon me-3"></i>
            <h2 class="h5 mb-0">Heart Rate Tracking</h2>
          </div>
          <p class="mb-2">
            Live HR zones (Recovery / Fat Burn / Aerobic / Anaerobic) — intensity at a glance.
          </p>
          <span class="badge bg-primary-subtle text-primary badge-tip">Demo</span>
          <div class="mt-2 small text-muted">
            Check zone distribution and VO₂max trends on the device or in the app.
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="p-4 bg-white border rounded h-100">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-moon-stars feature-icon me-3"></i>
            <h2 class="h5 mb-0">Sleep Tracking</h2>
          </div>
          <p class="mb-2">
            Detect Deep/Light/REM stages and combine with morning HRV for a recovery score.
          </p>
          <span class="badge bg-primary-subtle text-primary badge-tip">Demo</span>
          <div class="mt-2 small text-muted">
            If sleep is insufficient, the system suggests reducing volume or prioritizing recovery.
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="p-4 bg-white border rounded h-100">
          <div class="d-flex align-items-center mb-3">
            <i class="bi bi-bicycle feature-icon me-3"></i>
            <h2 class="h5 mb-0">Training Advice</h2>
          </div>
          <p class="mb-2">
            Based on temperature, wind and rain probability, recommend indoor or outdoor sessions.
          </p>
          <span class="badge bg-primary-subtle text-primary badge-tip">Weather API Demo</span>
          <div class="mt-2 small text-muted">
            Example: Hot & rainy → indoor equipment; Cool & breezy → outdoor run.
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- 天气 API + 运动建议（KPI + 建议块） -->
<section class="py-4">
  <div class="container">
    <div class="api-card p-4 bg-white border rounded">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <div>
          <h2 class="h5 mb-1">Live Weather · Training Suggestion</h2>
          <div class="text-muted small">
            Default location: Kuala Lumpur (click the button to use your location).
            Powered by <code>Open-Meteo</code>.
          </div>
        </div>
        <button id="btnLocate" class="btn btn-outline-primary btn-sm">Use My Location</button>
      </div>

      <div class="row g-3 text-center">
        <div class="col-6 col-md-3">
          <div class="border rounded p-3">
            <div class="kpi" id="kpiTemp">--°C</div>
            <div class="text-muted">Temperature</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="border rounded p-3">
            <div class="kpi" id="kpiWind">-- km/h</div>
            <div class="text-muted">Wind Speed</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="border rounded p-3">
            <div class="kpi" id="kpiRain">-- %</div>
            <div class="text-muted">Rain Probability*</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="border rounded p-3">
            <div class="kpi" id="kpiFeels">--°C</div>
            <div class="text-muted">Feels Like</div>
          </div>
        </div>
      </div>

      <div class="mt-4">
        <div id="suggestion" class="alert alert-secondary d-flex align-items-center" role="alert">
          <div class="spinner-border me-3" role="status" aria-hidden="true"></div>
          Fetching weather data…
        </div>
        <div class="small text-muted">
          *Rain probability based on the latest hourly forecast (demo calculation). For coursework display only.
        </div>
      </div>
    </div>
  </div>
</section>

<!-- 页尾 -->
<footer class="footer-elite text-white mt-5">
  <div class="container py-5 text-center">
    <div class="mb-3 d-flex justify-content-center gap-3">
      <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
      <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
      <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
    </div>

    <h5 class="fw-bold mb-3 brand-text">FitLife</h5>

    <div class="mb-3 small">
      <a class="footer-link" href="index.html">Home</a> │
      <a class="footer-link" href="exercises.html">Exercises</a> │
      <a class="footer-link" href="equipment.html">Equipment</a> │
      <a class="footer-link" href="features.html">Features</a> │
      <a class="footer-link" href="nutrition.html">Nutrition</a> │
      <a class="footer-link" href="contact.html">Contact</a>
    </div>

    <div class="small">© 2025 FitLife Reserves All Rights</div>
  </div>

  <a href="#" class="back-to-top"><i class="fas fa-arrow-up"></i></a>
</footer>

<!-- 公共JS -->
<script src="assets/css/js/common.js"></script>
<script src="assets/css/js/animation.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script>AOS.init({ once: true });</script>

<!-- ======= Weather API（jQuery 版本，中文注释）只保留这一段 ======= -->
<script>


  var DEFAULT_LAT = 3.139, DEFAULT_LON = 101.6869; // 吉隆坡

  // 工具：渲染 KPI + 文案建议（依据当前小时数据）
  function renderKPI(data){
    var t = data.current_weather?.temperature;   // 实时气温
    var w = data.current_weather?.windspeed;     // 实时风速

    // 计算当前小时索引，拿体感温度与降雨概率
    var idx = -1;
    try { idx = data.hourly.time.indexOf(data.current_weather.time); } catch(e){ idx = -1; }
    var feels = (idx>=0 ? data.hourly.apparent_temperature[idx] : data.hourly.apparent_temperature?.[0]);
    var rainP = (idx>=0 ? data.hourly.precipitation_probability[idx] : data.hourly.precipitation_probability?.[0]);

    // 写入页面
    $('#kpiTemp').text((t!=null?Math.round(t):'--') + '°C');
    $('#kpiWind').text((w!=null?Math.round(w):'--') + ' km/h');
    $('#kpiRain').text((rainP!=null?Math.round(rainP):'--') + ' %');
    $('#kpiFeels').text((feels!=null?Math.round(feels):'--') + '°C');

    // 训练建议
    var text='Great conditions for training.', cls='alert-success';
    if (rainP!=null && rainP>=60) { text='High chance of rain — consider indoor training.'; cls='alert-warning'; }
    else if ((t!=null&&t>=33) || (feels!=null&&feels>=35)) { text='Hot weather — hydrate well and reduce intensity.'; cls='alert-danger'; }
    else if (w!=null && w>=30) { text='Strong wind — prefer indoor strength or intervals.'; cls='alert-warning'; }
    else if (t!=null && t<=10) { text='Cold conditions — longer warm-up and layers.'; cls='alert-info'; }

    $('#suggestion')
      .removeClass('alert-secondary alert-success alert-warning alert-danger alert-info')
      .addClass('alert ' + cls)
      .text(text);
  }

  // jQuery 调用 Open-Meteo
  function fetchWeather(lat, lon){
    var url = 'https://api.open-meteo.com/v1/forecast'
            + '?latitude='+encodeURIComponent(lat)
            + '&longitude='+encodeURIComponent(lon)
            + '&current_weather=true'
            + '&hourly=apparent_temperature,precipitation_probability,wind_speed_10m';

    $.getJSON(url)
      .done(function(data){ renderKPI(data); })
      .fail(function(){
        $('#suggestion').removeClass('alert-secondary').addClass('alert alert-warning')
                        .text('Weather API unavailable');
      });
  }

  // 初次加载：默认城市
  fetchWeather(DEFAULT_LAT, DEFAULT_LON);

  // 定位按钮
  $('#btnLocate').on('click', function(){
    if(!navigator.geolocation){
      return $('#suggestion').removeClass('alert-secondary').addClass('alert alert-warning')
                             .text('Geolocation is not supported by this browser.');
    }
    $('#suggestion').removeClass().addClass('alert alert-secondary d-flex align-items-center')
                    .html('<div class="spinner-border me-3" role="status" aria-hidden="true"></div>Getting your location…');
    navigator.geolocation.getCurrentPosition(
      function(pos){ fetchWeather(pos.coords.latitude, pos.coords.longitude); },
      function(){  $('#suggestion').removeClass().addClass('alert alert-warning').text('Unable to retrieve your location.'); },
      { enableHighAccuracy:true, timeout:8000 }
    );
  });
</script>

</body>
</html>
